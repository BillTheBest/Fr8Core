<!DOCTYPE html><html><head><meta charset="utf-8"><title>Get Envelope Status Changes</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css"><style>@import url(http://fonts.googleapis.com/css?family=Roboto:400,700|Inconsolata|Raleway:200);.hljs-comment,.hljs-title{color:#8e908c}.hljs-variable,.hljs-attribute,.hljs-tag,.hljs-regexp,.ruby .hljs-constant,.xml .hljs-tag .hljs-title,.xml .hljs-pi,.xml .hljs-doctype,.html .hljs-doctype,.css .hljs-id,.css .hljs-class,.css .hljs-pseudo{color:#c82829}.hljs-number,.hljs-preprocessor,.hljs-pragma,.hljs-built_in,.hljs-literal,.hljs-params,.hljs-constant{color:#f5871f}.ruby .hljs-class .hljs-title,.css .hljs-rules .hljs-attribute{color:#eab700}.hljs-string,.hljs-value,.hljs-inheritance,.hljs-header,.ruby .hljs-symbol,.xml .hljs-cdata{color:#718c00}.css .hljs-hexcolor{color:#3e999f}.hljs-function,.python .hljs-decorator,.python .hljs-title,.ruby .hljs-function .hljs-title,.ruby .hljs-title .hljs-keyword,.perl .hljs-sub,.javascript .hljs-title,.coffeescript .hljs-title{color:#4271ae}.hljs-keyword,.javascript .hljs-function{color:#8959a8}.hljs{display:block;background:white;color:#4d4d4c;padding:.5em}.coffeescript .javascript,.javascript .xml,.tex .hljs-formula,.xml .javascript,.xml .vbscript,.xml .css,.xml .hljs-cdata{opacity:.5}body{color:black;background:white;font-family:'Roboto',Helvetica,sans-serif;font-size:14px;line-height:1.42}header{border-bottom:1px solid #f2f2f2;margin-bottom:12px}h1,h2,h3,h4,h5{color:black;margin:12px 0}h1 .permalink,h2 .permalink,h3 .permalink,h4 .permalink,h5 .permalink{margin-left:6px;opacity:0;transition:opacity .25s ease}h1:hover .permalink,h2:hover .permalink,h3:hover .permalink,h4:hover .permalink,h5:hover .permalink{opacity:1}h1{font-family:'Raleway',Helvetica,sans-serif;font-size:36px;font-weight:500}h2{font-family:'Raleway',Helvetica,sans-serif;font-size:30px;font-weight:500}h3{font-size:100%;text-transform:uppercase}h5{font-size:100%;font-weight:normal}p{margin:0 0 10px}p.choices{line-height:1.6}a{color:#428bca;text-decoration:none}li p{margin:0}dl dt{float:left;width:160px;clear:left;text-align:right;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:700}dl dd{margin-left:180px}blockquote{color:rgba(0,0,0,0.5);font-size:15.5px;padding:10px 20px;margin:12px 0;border-left:5px solid #e8e8e8}blockquote p:last-child{margin-bottom:0}pre{background-color:#f5f5f5;padding:12px;border:1px solid #cfcfcf;border-radius:6px}pre code{background-color:transparent;padding:0;border:none}code{color:#444;background-color:#f5f5f5;font-family:'Inconsolata',monospace;padding:1px 4px;border:1px solid #cfcfcf;border-radius:3px}ul,ol{padding-left:2em}table{border-collapse:collapse;border-spacing:0}table tr:nth-child(2n){background-color:#fafafa}table th,table td{padding:6px 12px;border:1px solid #d9d9d9}nav{position:fixed;top:24px;bottom:0;overflow-y:auto;right:0}nav .resource-group{padding:0}nav .resource-group .heading{position:relative}nav .resource-group .heading .chevron{position:absolute;top:12px;right:12px;opacity:.5}nav .resource-group .heading a{display:block;color:black;opacity:.7;border-left:2px solid transparent;margin:0}nav .resource-group .heading a:hover{border-left:2px solid black}nav ul{list-style-type:none;padding-left:0}nav ul a{display:block;font-size:13px;color:rgba(0,0,0,0.7);padding:8px 12px;border-top:1px solid #d9d9d9;border-left:2px solid transparent;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}nav ul a:hover{border-left:2px solid black}nav ul>li{margin:0}nav ul>li:first-child{margin-top:-12px}nav ul>li:last-child{margin-bottom:-12px}nav ul ul a{padding-left:24px}nav ul ul li{margin:0}nav ul ul li:first-child{margin-top:0}nav ul ul li:last-child{margin-bottom:0}nav>div>div>ul>li:first-child>a{border-top:none}.preload *{transition:none !important}.pull-left{float:left}.pull-right{float:right}.badge{display:inline-block;float:right;min-width:10px;min-height:14px;padding:3px 7px;font-size:12px;color:#000;background-color:#f2f2f2;border-radius:10px;margin-top:-2px;margin-bottom:-2px}.badge.get{color:#70bbe1;background-color:#d9edf7}.badge.head{color:#70bbe1;background-color:#d9edf7}.badge.options{color:#70bbe1;background-color:#d9edf7}.badge.put{color:#f0db70;background-color:#fcf8e3}.badge.patch{color:#f0db70;background-color:#fcf8e3}.badge.post{color:#93cd7c;background-color:#dff0d8}.badge.delete{color:#ce8383;background-color:#f2dede}.collapse-button{float:right}.collapse-button .close{display:none;color:#428bca;cursor:pointer}.collapse-button .open{color:#428bca;cursor:pointer}.collapse-button.show .close{display:inline}.collapse-button.show .open{display:none}.collapse-content{max-height:0;overflow:hidden;transition:max-height .3s ease-in-out}nav{width:220px}.container{max-width:940px;margin-left:auto;margin-right:auto}.container .row .content{margin-left:-35px;width:1050px}.container .row:after{content:'';display:block;clear:both}.container-fluid nav{width:22%}.container-fluid .row .content{margin-left:24%;width:76%}@media (max-width:1200px){nav{width:200px}.container{max-width:840px}.container .row .content{margin-left:224px;width:606px}}@media (max-width:992px){nav{width:170px}.container{max-width:720px}.container .row .content{margin-left:194px;width:526px}}@media (max-width:768px){nav{display:none}.container{width:95%;max-width:none}.container .row .content,.container-fluid .row .content{margin-left:auto;margin-right:auto;width:95%}}.back-to-top{position:fixed;z-index:1;bottom:0;right:24px;padding:4px 8px;color:rgba(0,0,0,0.5);background-color:#f2f2f2;text-decoration:none !important;border-top:1px solid #d9d9d9;border-left:1px solid #d9d9d9;border-right:1px solid #d9d9d9;border-top-left-radius:3px;border-top-right-radius:3px}.resource-group{padding:12px;margin-bottom:12px;background-color:white;border:1px solid #d9d9d9;border-radius:6px}.resource-group h2.group-heading,.resource-group .heading a{padding:12px;margin:-12px -12px 12px -12px;background-color:#f2f2f2;border-bottom:1px solid #d9d9d9;border-top-left-radius:6px;border-top-right-radius:6px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}nav .resource-group .heading a{margin-bottom:0}nav .resource-group .collapse-content{padding:0}.action{margin-bottom:12px;padding:12px 12px 0 12px;overflow:hidden;border:1px solid transparent;border-radius:6px}.action h4{padding:12px;margin:-12px -12px 12px -12px;border-bottom:1px solid transparent;border-top-left-radius:6px;border-top-right-radius:6px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.action h4 .name{float:right;font-weight:normal}.action h4 .method{padding:6px 12px;margin-right:12px;border-radius:3px}.action h4 .method.get{color:#fff;background-color:#337ab7}.action h4 .method.head{color:#fff;background-color:#337ab7}.action h4 .method.options{color:#fff;background-color:#337ab7}.action h4 .method.put{color:#000;background-color:#f0ad4e}.action h4 .method.patch{color:#000;background-color:#f0ad4e}.action h4 .method.post{color:#fff;background-color:#5cb85c}.action h4 .method.delete{color:#fff;background-color:#d9534f}.action h4 code{color:#444;background-color:#f5f5f5;border-color:#cfcfcf}.action dl.inner{padding-bottom:2px}.action .title{border-bottom:1px solid white;margin:0 -12px -1px -12px;padding:12px}.action.get{border-color:#bce8f1}.action.get h4{color:#337ab7;background:#d9edf7;border-bottom-color:#bce8f1}.action.head{border-color:#bce8f1}.action.head h4{color:#337ab7;background:#d9edf7;border-bottom-color:#bce8f1}.action.options{border-color:#bce8f1}.action.options h4{color:#337ab7;background:#d9edf7;border-bottom-color:#bce8f1}.action.post{border-color:#d6e9c6}.action.post h4{color:#5cb85c;background:#dff0d8;border-bottom-color:#d6e9c6}.action.put{border-color:#faebcc}.action.put h4{color:#f0ad4e;background:#fcf8e3;border-bottom-color:#faebcc}.action.patch{border-color:#faebcc}.action.patch h4{color:#f0ad4e;background:#fcf8e3;border-bottom-color:#faebcc}.action.delete{border-color:#ebccd1}.action.delete h4{color:#d9534f;background:#f2dede;border-bottom-color:#ebccd1}</style></head><body class="preload"><a href="#top" class="text-muted back-to-top"><i class="fa fa-toggle-up"></i>&nbsp;Back to top</a><div class="container"><div class="row"><nav><div class="resource-group"><div class="heading"><div class="chevron"><i class="open fa fa-angle-down"></i></div><a href="#top">Overview</a></div><div class="collapse-content"><ul><li><a href="#header-request-envelope-status-notes">Request Envelope Status Notes</a></li><li><a href="#header-url">URL</a></li><li><a href="#header-http-method">HTTP Method</a></li><li><a href="#header-parameters">Parameters</a></li><li><a href="#header-request">Request</a></li><li><a href="#header-example-request-body">Example Request Body</a></li><li><a href="#header-response">Response</a></li><li><a href="#header-example-request-body-1">Example Request Body</a></li></ul></div></div></nav><div class="content"><header><h1 id="top">Get Envelope Status Changes</h1></header><p>This returns envelope status changes for all envelopes. The information returned
can be modified by adding query strings to limit the request to check between
certain dates and times, or for certain envelopes, or for certain status codes.
It is recommended that you use one or more of the query strings in order to
limit the size of the response.</p>
<blockquote>
<p><strong>Important:</strong> Unless you are requesting the status for specific envelopes
(using envelopeIds or transactionIds), you must add a from_date in the request.</p>
<p>Getting envelope status using transactionIds is useful for offline signing
situations where it can be used determine if an envelope was created or not,
for the cases where a network connection was lost, before the envelope status could be returned.</p>
</blockquote>
<h3 id="header-request-envelope-status-notes">Request Envelope Status Notes <a class="permalink" href="#header-request-envelope-status-notes" aria-hidden="true">¶</a></h3>
<p>The REST API GET /envelopes call uses certain filters to find results. In some cases requests
are check for “any status change” instead of the just the single status requested. In these cases,
more envelopes might be returned by the request than otherwise would be. For example, for a request
with the begin date is set to Jan 1st, an end date set to Jan 7th and the status qualifier (from_to_status)
set to “Delivered” – the response set might contain envelopes that were created during that time period, but not
delivered during the time period.</p>
<p>To avoid unnecessary database queries, the DocuSign system checks requests to ensure that
the added filters will not result in a zero-size response before acting on the request. The
following table shows the valid envelope statuses (in the Valid Current Statuses column) for the
status qualifiers in the request. If the status and status qualifiers in the API request do not contain
any of the values shown in the valid current statuses column, then an empty list is returned.</p>
<p>For example, a request with a status qualifier (from_to_status) of “Delivered” and a status
of “Created,Sent”, DocuSign will always return an empty list. This is because the request essentially
translates to: find the envelopes that were Delivered between the begin and end dates that have a current
status of Created or Sent, and since an envelope that has been delivered can never have a status of Created
or Sent, a zero-size response would be generated. In this case, DocuSign does not run the request, but just returns
the empty list.</p>
<p>Client applications should check that the statuses they are requesting make sense for a given status qualifier.</p>
<table>
<thead>
<tr>
<th>Status Qualifier<br/>(from_to_status)</th>
<th>Effective Status Qualifier</th>
<th>Valid Current Statuses</th>
</tr>
</thead>
<tbody>
<tr>
<td>Any (changed)</td>
<td>StatusChanged</td>
<td>Any, Created, Sent, Delivered, Signed, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Created</td>
<td>Created</td>
<td>Any, Created, Sent, Delivered, Signed, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Sent</td>
<td>Sent</td>
<td>Any, Sent, Delivered, Signed, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Delivered</td>
<td>StatusChanged</td>
<td>Any, Delivered, Signed, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Signed</td>
<td>StatusChanged</td>
<td>Any, Signed, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Completed</td>
<td>Completed</td>
<td>Any, Completed, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>Declined</td>
<td>StatusChanged</td>
<td>Any, Declined, Voided, Deleted</td>
</tr>
<tr>
<td>TimedOut - Always return zero results</td>
<td>StatusChanged</td>
<td>Any, Voided, Deleted</td>
</tr>
<tr>
<td>Voided</td>
<td>Voided</td>
<td>Any, Voided, Deleted</td>
</tr>
<tr>
<td>Deleted</td>
<td>StatusChanged</td>
<td>Any, Deleted</td>
</tr>
</tbody>
</table>
<h2 id="header-url">URL <a class="permalink" href="#header-url" aria-hidden="true">¶</a></h2>
<pre><code>/accounts/<span class="hljs-list">{accountId}</span>/envelopes

<span class="hljs-keyword">Optional</span> query strings: from_date=<span class="hljs-list">{dateTime}</span>, to_date=<span class="hljs-list">{dateTime}</span>, status=<span class="hljs-list">{status code}</span>,
from_to_status=<span class="hljs-list">{changed or any or list of statuses}</span>, envelopeId=<span class="hljs-list">{envelopeId}</span>,
custom_field=<span class="hljs-list">{envelope custom field name}</span>=<span class="hljs-list">{envelope custom field value}</span>,
transaction_ids=<span class="hljs-list">{transactionId or request_body}</span></code></pre>
<h2 id="header-http-method">HTTP Method <a class="permalink" href="#header-http-method" aria-hidden="true">¶</a></h2>
<pre><code><span class="hljs-title">GET</span></code></pre>
<h2 id="header-parameters">Parameters <a class="permalink" href="#header-parameters" aria-hidden="true">¶</a></h2>
<p>There are no required parameters, but the following optional parameters can be added to narrow the search results.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>from_date</td>
<td>No*</td>
<td>dateTime</td>
<td>The date/time setting that specifies the date/time when the request begins checking for status changes for envelopes in the account.<br/><br/>* This is required unless envelopeIds are used.</td>
</tr>
<tr>
<td>to_date</td>
<td>No</td>
<td>dateTime</td>
<td>Optional date/time setting that specifies the date/time when the request stops for status changes for envelopes in the account. If no entry, the system uses the time of the call as the to_date.</td>
</tr>
<tr>
<td>from_to_status</td>
<td>No</td>
<td>EnvelopeStatusChange</td>
<td>This is the status type checked for in the from_date/to_date period. If “changed” is specified, then envelopes that changed status during the period are found. If for example, “created” is specified, then envelopes created during the period are found. Default is “changed”.<br/>Possible values are: Voided, Changed, Created, Deleted, Sent, Delivered, Signed, Completed, Declined, TimedOut and Processing.</td>
</tr>
<tr>
<td>status</td>
<td>No</td>
<td>String</td>
<td>The list of current statuses to include in the response. By default, all envelopes found are returned. If values are specified, then of the envelopes found, only those with the current status specified are returned in the results.<br/>Possible values are: Voided, Created, Deleted, Sent, Delivered, Signed, Completed, Declined, TimedOut and Processing.</td>
</tr>
<tr>
<td>ac_status</td>
<td>No</td>
<td>String</td>
<td>Specifies the Authoritative Copy Status for the envelopes. The possible values are: Unknown, Original, Transferred, AuthoritativeCopy, AuthoritativeCopyExportPending, AuthoritativeCopyExported, DepositPending, Deposited, DepositedEO, or DepositFailed.</td>
</tr>
<tr>
<td>envelopeId</td>
<td>No</td>
<td>String</td>
<td>The envelope ID for the envelope.</td>
</tr>
<tr>
<td>custom_field</td>
<td>No</td>
<td>String</td>
<td>This specifies the envelope custom field name and value searched for in the envelope information. The value portion of the query can use partial strings by adding ‘%’ (percent sign) around the custom field query value.<br/><br/>Example 1: If you have an envelope custom field called “Region” and you want to search for all envelopes where the value is “West” you would use the query: ?custom_field=Region=West.<br/><br/>Example 2: To search for envelopes where the ApplicationID custom field has the value or partial value of “DocuSign” in field, the query would be: ?custom_field=ApplicationId=%DocuSign% This would find envelopes where the custom field value is “DocuSign for Salesforce” or “DocuSign envelope.”</td>
</tr>
<tr>
<td>transactionId</td>
<td>No</td>
<td>String</td>
<td>If included in the query string, this is a comma separated list of envelope transactionIds.<br/>If included in the request_body, this is a list of envelope transactionIds.<br/><strong>Note:</strong> transactionIds are only valid in the DocuSign system for 7 days.</td>
</tr>
</tbody>
</table>
<h2 id="header-request">Request <a class="permalink" href="#header-request" aria-hidden="true">¶</a></h2>
<h3 id="header-example-request-body">Example Request Body <a class="permalink" href="#header-example-request-body" aria-hidden="true">¶</a></h3>
<pre><code>GET https://{server}/restapi/{apiVersion}/accounts/{accountId}/envelopes

X-DocuSign-Authentication: <span class="hljs-tag">&lt;<span class="hljs-title">DocuSignCredentials</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">Username</span>&gt;</span>{name}<span class="hljs-tag">&lt;/<span class="hljs-title">Username</span>&gt;</span>
                           <span class="hljs-tag">&lt;<span class="hljs-title">Password</span>&gt;</span>{password}<span class="hljs-tag">&lt;/<span class="hljs-title">Password</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-title">IntegratorKey</span>&gt;</span>
                           {integrator_key}<span class="hljs-tag">&lt;/<span class="hljs-title">IntegratorKey</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">DocuSignCredentials</span>&gt;</span>
Accept: application/json
Content-Type: application/json</code></pre>
<h2 id="header-response">Response <a class="permalink" href="#header-response" aria-hidden="true">¶</a></h2>
<p>The response returns the uri’s for the envelope certificate, custom fields, documents,
envelope along with the envelope ID, envelope status, and the date-time stamp for the
envelope status change for the envelopes. If a query string was added to the original request,
only the envelopes that meet those parameters are included in the response.</p>
<p>The following example shows the response json body.</p>
<h3 id="header-example-request-body-1">Example Request Body <a class="permalink" href="#header-example-request-body-1" aria-hidden="true">¶</a></h3>
<pre><code><span class="hljs-collection">{
<span class="hljs-collection">{
  <span class="hljs-string">"envelopes"</span>: <span class="hljs-collection">[<span class="hljs-collection">{
    <span class="hljs-string">"certificateUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"customFieldsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"documentsCombinedUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"documentsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"envelopeId"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"envelopeUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"notificationUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"recipientsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"statusChangedDateTime"</span>: <span class="hljs-string">"String content"</span>
  }</span>,
  <span class="hljs-collection">{
    <span class="hljs-string">"certificateUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"customFieldsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"documentsCombinedUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"documentsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"envelopeId"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"envelopeUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"notificationUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"recipientsUri"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"status"</span>: <span class="hljs-string">"String content"</span>,
    <span class="hljs-string">"statusChangedDateTime"</span>: <span class="hljs-string">"String content"</span>
  }</span>]</span>,
<span class="hljs-string">"resultSetSize"</span>: <span class="hljs-string">"String content"</span>}</span>
}</span></code></pre>
</div></div></div><p style="text-align: center;" class="text-muted">Generated by&nbsp;<a href="https://github.com/danielgtaylor/aglio" class="aglio">aglio</a>&nbsp;on 31 Jul 2015</p><script>/* eslint-env browser */
/* eslint quotes: [2, "single"] */
'use strict';

/*
  Determine if a string ends with another string.
*/
function endsWith(str, suffix) {
    return str.indexOf(suffix, str.length - suffix.length) !== -1;
}

/*
  Get an array [width, height] of the window.
*/
function getWindowDimensions() {
  var w = window,
      d = document,
      e = d.documentElement,
      g = d.body,
      x = w.innerWidth || e.clientWidth || g.clientWidth,
      y = w.innerHeight || e.clientHeight || g.clientHeight;

  return [x, y];
}

/*
  Collapse or show a request/response example.
*/
function toggleCollapseButton(event) {
    var button = event.target.parentNode;
    var content = button.parentNode.nextSibling;
    var inner = content.children[0];

    if (button.className.indexOf('collapse-button') === -1) {
      // Clicked without hitting the right element?
      return;
    }

    if (content.style.maxHeight && content.style.maxHeight !== '0px') {
        // Currently showing, so let's hide it
        button.className = 'collapse-button';
        content.style.maxHeight = '0px';
    } else {
        // Currently hidden, so let's show it
        button.className = 'collapse-button show';
        content.style.maxHeight = inner.offsetHeight + 12 + 'px';
    }
}

/*
  Collapse or show a navigation menu. It will not be hidden unless it
  is currently selected or `force` has been passed.
*/
function toggleCollapseNav(event, force) {
    var heading = event.target.parentNode;
    var content = heading.nextSibling;
    var inner = content.children[0];

    if (heading.className.indexOf('heading') === -1) {
      // Clicked without hitting the right element?
      return;
    }

    if (content.style.maxHeight && content.style.maxHeight !== '0px') {
      // Currently showing, so let's hide it, but only if this nav item
      // is already selected. This prevents newly selected items from
      // collapsing in an annoying fashion.
      if (force || window.location.hash && endsWith(event.target.href, window.location.hash)) {
        content.style.maxHeight = '0px';
      }
    } else {
      // Currently hidden, so let's show it
      content.style.maxHeight = inner.offsetHeight + 12 + 'px';
    }
}

/*
  Refresh the page after a live update from the server. This only
  works in live preview mode (using the `--server` parameter).
*/
function refresh(body) {
    document.querySelector('body').className = 'preload';
    document.body.innerHTML = body;

    // Re-initialize the page
    init();
    autoCollapse();

    document.querySelector('body').className = '';
}

/*
  Determine which navigation items should be auto-collapsed to show as many
  as possible on the screen, based on the current window height. This also
  collapses them.
*/
function autoCollapse() {
  var windowHeight = getWindowDimensions()[1];
  var itemsHeight = 64; /* Account for some padding */
  var itemsArray = Array.prototype.slice.call(
    document.querySelectorAll('nav .resource-group .heading'));

  // Get the total height of the navigation items
  itemsArray.forEach(function (item) {
    itemsHeight += item.parentNode.offsetHeight;
  });

  // Should we auto-collapse any nav items? Try to find the smallest item
  // that can be collapsed to show all items on the screen. If not possible,
  // then collapse the largest item and do it again. First, sort the items
  // by height from smallest to largest.
  var sortedItems = itemsArray.sort(function (a, b) {
    return a.parentNode.offsetHeight - b.parentNode.offsetHeight;
  });

  while (sortedItems.length && itemsHeight > windowHeight) {
    for (var i = 0; i < sortedItems.length; i++) {
      // Will collapsing this item help?
      var itemHeight = sortedItems[i].nextSibling.offsetHeight;
      if ((itemsHeight - itemHeight <= windowHeight) || i === sortedItems.length - 1) {
        // It will, so let's collapse it, remove its content height from
        // our total and then remove it from our list of candidates
        // that can be collapsed.
        itemsHeight -= itemHeight;
        toggleCollapseNav({target: sortedItems[i].children[0]}, true);
        sortedItems.splice(i, 1);
        break;
      }
    }
  }
}

/*
  Initialize the interactive functionality of the page.
*/
function init() {
    var i;

    // Make collapse buttons clickable
    var buttons = document.querySelectorAll('.collapse-button');
    for (i = 0; i < buttons.length; i++) {
        buttons[i].onclick = toggleCollapseButton;

        // Show by default? Then toggle now.
        if (buttons[i].className.indexOf('show') !== -1) {
            toggleCollapseButton({target: buttons[i].children[0]});
        }
    }

    // Make nav items clickable to collapse/expand their content.
    var navItems = document.querySelectorAll('nav .resource-group .heading');
    for (i = 0; i < navItems.length; i++) {
        navItems[i].onclick = toggleCollapseNav;

        // Show all by default
        toggleCollapseNav({target: navItems[i].children[0]});
    }
}

// Initial call to set up buttons
init();

window.onload = function () {
    autoCollapse();
    // Remove the `preload` class to enable animations
    document.querySelector('body').className = '';
};
</script></body></html>