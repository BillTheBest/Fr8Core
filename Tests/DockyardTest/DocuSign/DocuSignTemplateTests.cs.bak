using System;
using System.Collections.Generic;
using System.Linq;
using Data.Interfaces;

using DocuSign.Integrations.Client;

using NUnit.Framework;
using Utilities;

using UtilitiesTesting;
using UtilitiesTesting.DocusignTools;
using UtilitiesTesting.DocusignTools.Interfaces;
using UtilitiesTesting.Fixtures;
using Data.Interfaces.DataTransferObjects;
using Data.Migrations;
using Data.Wrappers;
using Newtonsoft.Json;
using StructureMap;

namespace DockyardTest.DocuSign
{
    [TestFixture]
    public class DocuSignTemplateTests : BaseTest
    {
        private readonly IDocusignApiHelper docusignApiHelper;
        private IDocuSignTemplate _docusignTemplate;

        public DocuSignTemplateTests()
        {
            //docusignApiHelper = new DocusignApiHelper();
        }

        [SetUp]
        public void SetUpTest()
        {
            _docusignTemplate = ObjectFactory.GetInstance<IDocuSignTemplate>();

        }

        //[Test, Ignore]
        //[Category("DocuSignIntegration")]
        //public void Template_Can_Get_Template()
        //{
        //    DocuSignAccount account = docusignApiHelper.LoginDocusign(FixtureData.TestDocuSignAccount1(),
        //                                                      FixtureData.TestRestSettings1());

        //    TemplateInfo curTemplateInfo = FixtureData.TestDocuSignTemplateInfo1();         
        //    //post the template to the test account
        //    TemplateInfo createdTemplateInfo = _docusignTemplate.Create(curTemplateInfo);

        //    //get it
        //    //TemplateInfo retrievedTemplateInfo = _docusignTemplate.GetTemplate(createdTemplateInfo.Id);

        //    //verify
        //    //delete it

        //    Assert.IsNotNull(account); //Todo orkan: remove back when you completed the EnvelopeService.
        //}

        [Test]
        [Ignore]
        // This is more of an integration test
        // test this to make sure docusign is returning values
        // Template id is "b5abd63a-c12c-4856-b9f4-989200e41a6f"
        // <add key="username" value="a@thakral.in" />
        // <add key = "password" value="foobar1" />
        // <add key = "IntegratorKey" value="TEST-ddb13d45-cc4f-4573-9c37-f75712565ed1" />
        // <add key = "BaseUrl" value="https://demo.docusign.net/restapi/v2/accounts/1142188/" />

        public void Can_Return_List_Of_Fields()
        {
            var fields = _docusignTemplate.GetMappableSourceFields(FixtureData.TestTeamplateId).ToList();

            Assert.IsNotNull(fields);
            Console.Write(JsonConvert.SerializeObject(fields));
        }

    }
}